![caubasephotos2](https://github.com/Uks130322/pereval/assets/101522861/2cef4890-8ebd-4f29-b3ac-bd86e15228b8)

# Pereval API
  
## https://nataliatkachuk.pythonanywhere.com/api/pereval/

На сайте https://pereval.online/ ФСТР ведёт базу горных перевалов, которая пополняется туристами.

После преодоления очередного перевала, турист заполняет отчёт в формате PDF и отправляет его на электронную почту федерации. Экспертная группа ФСТР получает эту информацию, верифицирует, а затем вносит её в базу, которая ведётся в Google-таблице.

ФСТР заказала студентам SkillFactory разработать мобильное приложение для Android и IOS, которое упростило бы туристам задачу по отправке данных о перевале и сократило время обработки запроса до трёх дней.

Пользоваться мобильным приложением будут туристы. В горах они будут вносить данные о перевале в приложение и отправлять их в ФСТР, как только появится доступ в Интернет.

Модератор из федерации будет верифицировать и вносить в базу данных информацию, полученную от пользователей, а те в свою очередь смогут увидеть в мобильном приложении статус модерации и просматривать базу с объектами, внесёнными другими.


## Метод POST /pereval/
Пример JSON-а:
```JSON
{
  "beauty_title": "пер. ",
  "title": "Пхия",
  "other_titles": "Триев",
  "connect": "что соединяет, текстовое поле",
 
  "add_time": "2021-09-22 13:18:13",
  "user": {"email": "qwerty@mail.ru", 		
        "fam": "Пупкин",
		 "name": "Василий",
		 "otc": "Иванович",
        "phone": "+7 555 55 55"}, 
 
   "coords":{
  "latitude": "45.3842",
  "longitude": "7.1525",
  "height": "1200"}
 
 
  "level": {"winter": "",
  "summer": "1А",
  "autumn": "1А",
  "spring": ""},
 
   "images": [{"data": "<картинка1>", "title": "Седловина"}, {"data": "<картинка>", "title": "Подъём"}]
}
```
Результат метода: JSON

status — код HTTP, целое число:

	500 — ошибка при выполнении операции;
	400 — Bad Request (при нехватке полей);
	200 — успех.

message — строка:

	Причина ошибки (если она была) либо пустая строка.

Если отправка успешна, дополнительно возвращается id вставленной записи.
id — идентификатор, который был присвоен объекту при добавлении в базу данных.

Допустимые значения поля Status:

	-'new': 'Ожидает модерацию' - по умолчанию,
	-'pending': 'Принято на модерацию',
	-'accepted': 'Модерация пройдена успешно',
	-'rejected': 'Модерация завершена, отклонено'  

 
## Метод GET /pereval/<id>/
Получает одну запись о перевале по id.  


## Метод GET /pereval/?user_id__email=<email>/
Получает все данные пользователя по его email-адресу.  
Реализовано при помощи фильтрации по email-адресу пользователя с помощью пакета django-filter.  


## Метод PUT /pereval/<id>/
Обновляет запись по id. Доступно только для записей со статусом 'new'; изменение данных пользователя запрещено.

Результат метода: JSON  
state:

	1 — при успешном отредактировании записи в базе данных.
	0 — в противном случае.
message:

	сообщение при ошибке либо пустая строка.


 #### Документация сгенерирована с помощью пакета drf-yasg
 	/swagger/ - schema swagger-ui
  	/swagger<format>/ - schema json
   	/redoc/ - schema redoc  

     
![Screenshot_2](https://github.com/Uks130322/pereval/assets/101522861/f322c3ba-308f-4255-a703-730e366357ee)


![Screenshot_1](https://github.com/Uks130322/pereval/assets/101522861/14dbd9b5-8d63-40a1-9e05-207e775730b8)
